### Variables
@baseUrl = https://8437b7a01aff.ngrok-free.app
@apiKey = MyCamAPI_7x9K2mP4nQ8vW5yZ3bC6hJ1lR0tS
@cameraApiKey = CamRegister_7f9a2b5e8c1d4a6b93e0f2d1c5b8a472
@token = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MSwiZW1haWwiOiJhdWd1c3RpbkB0ZXN0LmNvbSIsImlhdCI6MTc2NzA4NzE0NCwiZXhwIjoxNzY3MTczNTQ0fQ.o_gllX5wI3N1BS-yp0782rAZexWZepJLJtJJJjjXaSo
@camKey = cam_esp32_002

### Health Check
GET {{baseUrl}}/health

###############################################
# AUTH ROUTES
###############################################

### Register - Créer un nouvel utilisateur
POST {{baseUrl}}/auth/register
Content-Type: application/json
X-API-Key: {{apiKey}}
X-Camera-API-Key: {{cameraApiKey}}

{
  "lastname": "Seguin",
  "firstname": "Augustin",
  "email": "augustin@test.com",
  "password": "Password123"
}

### Login - Authentification
POST {{baseUrl}}/auth/login
Content-Type: application/json
X-API-Key: {{apiKey}}

{
  "email": "augustin@test.com",
  "password": "Password123"
}

###############################################
# CAMERA ROUTES
###############################################

### Créer une nouvelle caméra (nécessite JWT + API Key)
POST {{baseUrl}}/cameras/create
Content-Type: application/json
Authorization: Bearer {{token}}
X-API-Key: {{apiKey}}

{
  "name": "Caméra Salon",
  "cam_key": "{{camKey}}"
}

### Récupérer mes caméras (nécessite JWT)
GET {{baseUrl}}/cameras/my-cameras
Authorization: Bearer {{token}}
X-API-Key: {{apiKey}}

### Supprimer une caméra (nécessite JWT + API Key)
DELETE {{baseUrl}}/cameras/1
Authorization: Bearer {{token}}
X-API-Key: {{apiKey}}

### Flux vidéo en temps réel (nécessite API Key)
GET {{baseUrl}}/cameras/video/{{camKey}}
Authorization: Bearer {{token}}
X-API-Key: {{apiKey}}

### Envoyer une notification (nécessite API Key) - Simule l'ESP32
POST {{baseUrl}}/cameras/notification/{{camKey}}
Content-Type: application/json
X-API-Key: {{apiKey}}
X-Camera-API-Key: {{cameraApiKey}}

{
  "type": "motion",
  "message": "Mouvement détecté par la caméra",
  "timestamp": 1702469789
}

### Test notification sans timestamp
POST {{baseUrl}}/cameras/notification/{{camKey}}
Content-Type: application/json
X-API-Key: {{apiKey}}
X-Camera-API-Key: {{cameraApiKey}}

{
  "type": "motion",
  "message": "Mouvement détecté par la caméra"
}

###############################################
# ERROR TESTS
###############################################

### Test sans API Key (devrait échouer)
GET {{baseUrl}}/cameras/video/{{camKey}}

### Test avec mauvaise API Key
GET {{baseUrl}}/cameras/video/{{camKey}}
X-API-Key: WRONG_KEY

### Test caméra inexistante
GET {{baseUrl}}/cameras/video/cam_inexistante
X-API-Key: {{apiKey}}

### Test notification sans type/message
POST {{baseUrl}}/cameras/notification/{{camKey}}
Content-Type: application/json
X-API-Key: {{apiKey}}

{
  "type": "motion"
}
